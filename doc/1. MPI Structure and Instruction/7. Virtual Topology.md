# 7. Virtual Topology
- Author: JaeDuk Yoo(woejr120@gmail.com)
- Date: 2019.07.13
---
---
## Virtual Topology
### Topology
- 실제 세계에선 클러스터 내의 모든 노드는 같은 위상에 존재한다. 즉, 하나의 큰 데이터를 분할하여 각 노드에 할당해줄때, 각각 어떤 노드에 어느 위치의 데이터가 할당될지 알 수 없다.
- 이와 같은 문제를 해결하기 위해 노드들 사이에 가상의 위상을 정해준다.
- 일반적으론 격자 형태로 위상을 배분하며, 이를 어떤 방식으로 통신하는가에 따라 Cartesian Model과 Graph Model로 나뉜다.
    ```text
        Raw Data           Sepearted Data     
    [            ] ---> [   ][   ][   ][   ]    [   ] -> 1 process task
    [            ]      [   ][   ][   ][   ]
    [            ]      [   ][   ][   ][   ]
    [            ]      [   ][   ][   ][   ]

    [   ][   ][   ][   ][   ][   ][   ][   ][   ][   ][   ][   ][   ][   ][   ][   ] 
    -> 일반적인 클러스터 구조. 서로 같은 위상에 존재하며 분리된 데이터를 랜덤으로 배정해준다. 즉, 정보를 취합하기 위해선 마스터 노드가 어떤 프로세서에 어떤 데이터가 배정되었는지 알고 있어야 함.

    [0,0][0,1][0,2][0,3]
    [1,0][1,1][1,2][1,3]
    [2,0][2,1][2,2][2,3]
    [3,0][3,1][3,2][3,3]
    -> 가상으로 위상이 분배된 클러스터 구조. 각 프로세서는 Raw Data의 정해진 부분을 담당하기 때문에 마스터 노드가 이에 대한 정보가 따로 필요 없다.
    ```

#### 1. Cartesian Model
- 2차원 혹은 3차원 격자에 각 노드들을 mapping하는 방식.
- 그래프 모델에 비해 이해하기 쉽지만 성능면에선 한계가 있다.
- 각 노드가 처리하는 데이터의 위치를 직교 좌표계 형태로 정해둔다고 생각하면 됨.
- 이때, 일반적으로 서로 인접해있는 노드끼리만 통신이 가능하도록 허락해준다. -> 성능의 한계가 있는 결정적인 이유
```text
[0,0][0,1][0,2][0,3]
[1,0][1,1][1,2][1,3]
[2,0][2,1][2,2][2,3]
[3,0][3,1][3,2][3,3]

[0,0] -> [0,1], [1,0], [0,3] 노드와 통신 가능
[1,1] -> [1,0], [0,1], [1,2], [2,1] 노드와 통신 가능
.
.
.
```

#### 2. Graph Model
- Cartesian Model보다 효율적이지만, 약간 더 난이도가 높은 편.
- 직교 좌표 형태로 데이터를 mapping하는 것은 동일하지만, 두 노드간의 통신을 그래프 형태로 나타낸다
    ```text
    [0,0] [0,1] [0,2]
    [1,0] [1,1] [1,2] 
    [2,0] [2,1] [2,2]

    Graph by text
    [0,0] -> [0,0], [0,1], [0,2], [1,0], [1,1], [1,2], [2,0], [2,1], [2,2]
    -> [0,0] 노드는 모든 노드에 데이터 송신 가능

    [1,1] : [0,1], [2,2], [1,2], [1,1]
    -> [1,1] 노드는 [0,1], [2,2], [1,2] 노드에 데이터를 송신 가능

    [1,2] -> [0,0], [1,2]
    -> [1,2] 노드는 [0,0] 노드에만 데이터 송신 가능
    ```
---
### Cartesian Model

---
### 대응 함수
---
### Toppology Split
---